{include file='public/head'}
{include file='public/nav'}
<!-- Main Content -->
<div class="main-content">
    <section class="section">
        <div class="section-header">
            <h1>个人设置</h1>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="form-group">
                            <label>用户名</label>
                            <input type="text" class="form-control" maxlength="12" value="{$USER.username}" disabled>
                        </div>
                        <div class="form-group">
                            <label>显示名称</label>
                            <input type="text" class="form-control" id="displayname" value="{$USER.displayname}" maxlength="12">
                        </div>
                        <div class="form-group">
                            <label>个人描述</label>
                            <textarea class="form-control" id="description" maxlength="150">{$USER.u_description}</textarea>
                        </div>
                        <div class="form-group">
                            <label>邮箱</label>
                            <input type="email" class="form-control" id="email" value="{$USER.email}" maxlength="25">
                        </div>
                        <div class="form-group">
                            <button type="button" onclick="update_info()" class="btn btn-secondary">更新</button>
                        </div>
                        <div id="tip_list"></div>
                    </div>
                    <script type="application/javascript">
                        function update_info(){
                            var displayname = document.getElementById("displayname").value;
                            var description = document.getElementById("description").value;
                            var email = document.getElementById("email").value;
                            fetch("/user.php/settings/check",{method:"post",headers: {"Content-Type":"application/x-www-form-urlencoded"},body:`displayname=${displayname}&&description=${description}&&email=${email}`})
                                .then(res => res.text())
                                .then(function (res){
                                    if (res === "ok") document.getElementById("tip_list").innerHTML = "<h5 class=\"tip\" style='color: limegreen;'>更新成功</h5>";
                                    else document.getElementById("tip_list").innerHTML = "<h5 class=\"tip\">" + res + "</h5>";
                                })
                        }
                    </script>
                </div>
            </div>
        </div>
    </section>
</div>
{include file='public/foot'}